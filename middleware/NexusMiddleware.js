(function(_0x415cac,_0x2b192b){const _0x2ce2b4=_0x3c8b,_0x259601=_0x415cac();while(!![]){try{const _0x58be64=-parseInt(_0x2ce2b4(0x224))/0x1+parseInt(_0x2ce2b4(0x1be))/0x2+-parseInt(_0x2ce2b4(0x207))/0x3*(-parseInt(_0x2ce2b4(0x209))/0x4)+-parseInt(_0x2ce2b4(0x20a))/0x5*(parseInt(_0x2ce2b4(0x20f))/0x6)+-parseInt(_0x2ce2b4(0x225))/0x7*(parseInt(_0x2ce2b4(0x1cb))/0x8)+parseInt(_0x2ce2b4(0x1f9))/0x9+-parseInt(_0x2ce2b4(0x1df))/0xa*(parseInt(_0x2ce2b4(0x228))/0xb);if(_0x58be64===_0x2b192b)break;else _0x259601['push'](_0x259601['shift']());}catch(_0x2260ec){_0x259601['push'](_0x259601['shift']());}}}(_0x2379,0x454fc));const _0x1b272d=(function(){let _0xcb10b4=!![];return function(_0x5f453e,_0x24307d){const _0x271a7a=_0xcb10b4?function(){const _0x361d82=_0x3c8b;if(_0x24307d){const _0x3683ee=_0x24307d[_0x361d82(0x1c1)](_0x5f453e,arguments);return _0x24307d=null,_0x3683ee;}}:function(){};return _0xcb10b4=![],_0x271a7a;};}()),_0x1ece8a=_0x1b272d(this,function(){const _0x34cfe4=_0x3c8b,_0x4bfe8d={'yrdfd':_0x34cfe4(0x1e7)};return _0x1ece8a['toString']()[_0x34cfe4(0x1c8)](_0x4bfe8d[_0x34cfe4(0x204)])[_0x34cfe4(0x20e)]()[_0x34cfe4(0x20d)](_0x1ece8a)[_0x34cfe4(0x1c8)](_0x4bfe8d[_0x34cfe4(0x204)]);});_0x1ece8a();function _0x3c8b(_0x2754fd,_0x212f84){_0x2754fd=_0x2754fd-0x1be;const _0x5a26db=_0x2379();let _0x2d411d=_0x5a26db[_0x2754fd];if(_0x3c8b['jnlvkr']===undefined){var _0x1b2b4d=function(_0x5ea403){const _0x41a994='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x1ece8a='',_0x1b272d='',_0x2379a9=_0x1ece8a+_0x1b2b4d;for(let _0x3c8b13=0x0,_0x265992,_0x8bccde,_0x6bc6e=0x0;_0x8bccde=_0x5ea403['charAt'](_0x6bc6e++);~_0x8bccde&&(_0x265992=_0x3c8b13%0x4?_0x265992*0x40+_0x8bccde:_0x8bccde,_0x3c8b13++%0x4)?_0x1ece8a+=_0x2379a9['charCodeAt'](_0x6bc6e+0xa)-0xa!==0x0?String['fromCharCode'](0xff&_0x265992>>(-0x2*_0x3c8b13&0x6)):_0x3c8b13:0x0){_0x8bccde=_0x41a994['indexOf'](_0x8bccde);}for(let _0x548b30=0x0,_0x412934=_0x1ece8a['length'];_0x548b30<_0x412934;_0x548b30++){_0x1b272d+='%'+('00'+_0x1ece8a['charCodeAt'](_0x548b30)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x1b272d);};_0x3c8b['RcbHtZ']=_0x1b2b4d,_0x3c8b['hWbQew']={},_0x3c8b['jnlvkr']=!![];}const _0x217b61=_0x5a26db[0x0],_0x2bff6c=_0x2754fd+_0x217b61,_0x41fe75=_0x3c8b['hWbQew'][_0x2bff6c];if(!_0x41fe75){const _0x4055fd=function(_0x384237){this['YWSEKQ']=_0x384237,this['ZdedvX']=[0x1,0x0,0x0],this['AysvYL']=function(){return'newState';},this['iMqOry']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['ddvrUA']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0x4055fd['prototype']['GGaiRT']=function(){const _0x3a0bfb=new RegExp(this['iMqOry']+this['ddvrUA']),_0x2e4c94=_0x3a0bfb['test'](this['AysvYL']['toString']())?--this['ZdedvX'][0x1]:--this['ZdedvX'][0x0];return this['TJnuss'](_0x2e4c94);},_0x4055fd['prototype']['TJnuss']=function(_0x26474f){if(!Boolean(~_0x26474f))return _0x26474f;return this['NOilRH'](this['YWSEKQ']);},_0x4055fd['prototype']['NOilRH']=function(_0x654926){for(let _0x26eb92=0x0,_0x2cd92e=this['ZdedvX']['length'];_0x26eb92<_0x2cd92e;_0x26eb92++){this['ZdedvX']['push'](Math['round'](Math['random']())),_0x2cd92e=this['ZdedvX']['length'];}return _0x654926(this['ZdedvX'][0x0]);},new _0x4055fd(_0x3c8b)['GGaiRT'](),_0x2d411d=_0x3c8b['RcbHtZ'](_0x2d411d),_0x3c8b['hWbQew'][_0x2bff6c]=_0x2d411d;}else _0x2d411d=_0x41fe75;return _0x2d411d;}const _0x5ea403=(function(){let _0x3be748=!![];return function(_0x1932a3,_0x2e4508){const _0xdfdc67=_0x3be748?function(){const _0x7aa249=_0x3c8b;if(_0x2e4508){const _0x2cb65a=_0x2e4508[_0x7aa249(0x1c1)](_0x1932a3,arguments);return _0x2e4508=null,_0x2cb65a;}}:function(){};return _0x3be748=![],_0xdfdc67;};}());(function(){const _0x4cb8f1=_0x3c8b,_0x556d4d={'bpwuz':_0x4cb8f1(0x1fc),'hAeVX':'chain','xiAFZ':function(_0x55b2a5,_0x2fd76b){return _0x55b2a5+_0x2fd76b;},'ffJCn':_0x4cb8f1(0x1d8),'bpLoH':function(_0x43f162,_0x29b679){return _0x43f162(_0x29b679);},'qrGKp':function(_0x4e1716){return _0x4e1716();},'cUnPO':function(_0x264bbc,_0x2e6677,_0x5bfa41){return _0x264bbc(_0x2e6677,_0x5bfa41);}};_0x556d4d[_0x4cb8f1(0x1dc)](_0x5ea403,this,function(){const _0x1982bd=_0x4cb8f1,_0x506fa6=new RegExp(_0x1982bd(0x21d)),_0x1ecd10=new RegExp(_0x556d4d[_0x1982bd(0x1d9)],'i'),_0x36af2a=_0x41fe75(_0x1982bd(0x1eb));!_0x506fa6['test'](_0x36af2a+_0x556d4d[_0x1982bd(0x1e2)])||!_0x1ecd10[_0x1982bd(0x1d6)](_0x556d4d[_0x1982bd(0x1c3)](_0x36af2a,_0x556d4d[_0x1982bd(0x1fb)]))?_0x556d4d[_0x1982bd(0x1dd)](_0x36af2a,'0'):_0x556d4d[_0x1982bd(0x1fa)](_0x41fe75);})();}());const _0x1b2b4d=(function(){let _0x14eefa=!![];return function(_0xab2d90,_0x7928e2){const _0x229d16=_0x14eefa?function(){const _0x1f817a=_0x3c8b;if(_0x7928e2){const _0x538091=_0x7928e2[_0x1f817a(0x1c1)](_0xab2d90,arguments);return _0x7928e2=null,_0x538091;}}:function(){};return _0x14eefa=![],_0x229d16;};}()),_0x2d411d=_0x1b2b4d(this,function(){const _0x4cf7c2=_0x3c8b,_0xc58dce={'aAPHb':function(_0x123d50,_0x24fa63){return _0x123d50(_0x24fa63);},'qwGIW':function(_0x3c3f6b,_0x4064c6){return _0x3c3f6b+_0x4064c6;},'MAYds':_0x4cf7c2(0x1cf),'PxVNu':_0x4cf7c2(0x205),'DixfH':function(_0x3ba9a6){return _0x3ba9a6();},'wInVH':_0x4cf7c2(0x1f7),'CbFJQ':'warn','PRYUN':_0x4cf7c2(0x220),'GpiRl':_0x4cf7c2(0x1fe),'OiguM':_0x4cf7c2(0x1f2),'WFIqQ':_0x4cf7c2(0x1d7),'TEUvL':function(_0x168a1e,_0x1c4d86){return _0x168a1e<_0x1c4d86;}};let _0x389b12;try{const _0x3f8f5b=_0xc58dce['aAPHb'](Function,_0xc58dce[_0x4cf7c2(0x1f0)](_0xc58dce[_0x4cf7c2(0x215)]+_0xc58dce[_0x4cf7c2(0x1f6)],');'));_0x389b12=_0xc58dce[_0x4cf7c2(0x1c5)](_0x3f8f5b);}catch(_0x44f2ab){_0x389b12=window;}const _0x5bd105=_0x389b12[_0x4cf7c2(0x1e6)]=_0x389b12[_0x4cf7c2(0x1e6)]||{},_0x359493=[_0xc58dce['wInVH'],_0xc58dce[_0x4cf7c2(0x1bf)],_0xc58dce[_0x4cf7c2(0x226)],_0xc58dce[_0x4cf7c2(0x1f8)],_0x4cf7c2(0x1e1),_0xc58dce[_0x4cf7c2(0x214)],_0xc58dce['WFIqQ']];for(let _0x34818d=0x0;_0xc58dce['TEUvL'](_0x34818d,_0x359493[_0x4cf7c2(0x1cc)]);_0x34818d++){const _0x2371aa=_0x1b2b4d['constructor']['prototype'][_0x4cf7c2(0x1cd)](_0x1b2b4d),_0x2686a6=_0x359493[_0x34818d],_0x3e0d83=_0x5bd105[_0x2686a6]||_0x2371aa;_0x2371aa['__proto__']=_0x1b2b4d[_0x4cf7c2(0x1cd)](_0x1b2b4d),_0x2371aa['toString']=_0x3e0d83[_0x4cf7c2(0x20e)][_0x4cf7c2(0x1cd)](_0x3e0d83),_0x5bd105[_0x2686a6]=_0x2371aa;}});_0x2d411d();function _0x2379(){const _0xd9d3da=['twLKzgXLD2fYzsbqyw5PyW','uhnXzuG','zgvIDq','Aw5PDa','wc1ozxH1CY1qAw5N','DxnLCI1Hz2vUDa','Ahj0Aw1L','s2Hrt2y','CxDhsvC','C3rYAw5NAwz5','DgfIBgu','y291BNrLCG','q3neqwW','C3rHDgvpyMPLy3q','uhHwtNu','Bg9N','r3bPuMW','mJm5otC3ogTNrxrUqq','Cxjhs3a','zMzkq24','xcTCkYaQkd86w2eTEKeTwL8KxvSWltLHlxPblvPFjf0Qkq','z2DLCG','zxjYB3i','mti3lJaUmc4X','C0rYBNm','q29UDgvUDc1uExbL','y0T2tNK','yNjVywrJyxn0','ExjKzMq','E30Uy29UC3rYDwn0B3iOiNjLDhvYBIb0AgLZiIKOicK','C2v0sgvHzgvY','nMLsA0LOBq','B2PwDeu','ota0mtK2t3zltvfc','mtvpr1nOEfO','wMndyLu','Dg9mB3DLCKnHC2u','y29UC3rYDwn0B3i','Dg9tDhjPBMC','mtaYmde1nMTMDwjyEa','y2XIzeG','qKjlsfq','CMvHC29U','veHKywW','t2LNDu0','tufzzhm','ANnVBG','Dg9gAxHLza','t3DItfG','AgvHzgvYCW','DxrrEw4','y29Kzq','C29JA2v0','zNvUy3rPB24GkLWOicPCkq','C3bSAxq','DhjHzMzPyW','Aw5MBW','yxbWBgLJyxrPB24VANnVBG','BhH6sMW','q0rMue8','mte5mdCZvxf3tKj3','mtuZm3zRrwjTqW','ufjzvu4','zMLYzxDHBgW','ody5B0nqqKPq','zw5K','l25LEhvZlwfKBwLU','qNLIBu0','yLvYCe4','wc1qB3DLCMvKluj5','ywn0Aw9U','mtaXmtiWofzACLDbtW','q2jgsLe','vgHYzwf0iejSB2nRzwq','yxbWBhK','l25LEhvZlxDZ','EgLbrLO','BNv1Chq','rgL4zKG','Dwr6rNG','CMvTB3rLqwrKCMvZCW','C2vHCMnO','D01euKy','Bg9NuMvXDwvZDa','mZa0mgDlAeP0sq','BgvUz3rO','yMLUza','DhnWyNy','CMv0DxjUicHMDw5JDgLVBIGPia','y2XWyMS','C3rHDhvZq29Kzq','vM9WBuW','z2vUzxjHDgu','DxjS','C3rHDhvZ','DgvZDa','DhjHy2u','Aw5WDxq','yNb3DxO','ywXSB3DLza','D2zuB04','y1vUue8','yNbmB0G','zMfeqvC','mJG4nZbNtNLqzvC','DuDTAgO','zxHJzxb0Aw9U','AefLvLG','zMf2AwnVBI5Py28','Aw5JBhvKzxm','t3fMze0','y29UC29Szq','kcGOlISPkYKRksSK'];_0x2379=function(){return _0xd9d3da;};return _0x2379();}import _0x4b0834 from'../security/Fingerprint.js';import _0x1d815d from'../monitor/Logger.js';export const nexusGuard=_0x581e91=>{const _0x505c32=_0x3c8b,_0x3b81b4={'tspbv':_0x505c32(0x201),'BBKHT':_0x505c32(0x221),'nuupt':'x-forwarded-for','udzFx':_0x505c32(0x1ff),'clbdH':_0x505c32(0x22a),'bUrpN':_0x505c32(0x1c2),'OwbLX':function(_0x5102d4){return _0x5102d4();},'ojVtE':function(_0x19a441,_0x4792d0){return _0x19a441+_0x4792d0;},'fqHYb':function(_0x28f405,_0x9e4b5f){return _0x28f405*_0x9e4b5f;},'ZEKqi':function(_0x11ea6a,_0x440852){return _0x11ea6a*_0x440852;},'uGmhj':function(_0x133632,_0x2112df){return _0x133632(_0x2112df);},'clpbk':_0x505c32(0x21f),'VopmL':_0x505c32(0x1c0),'lxzJl':'NEXUS_V4','CsDAl':_0x505c32(0x1ec),'OqfdM':_0x505c32(0x1e8)};return async(_0x2053e9,_0x4b3e61,_0x2c08ba)=>{const _0x1123e3=_0x505c32,_0x5b8be5={'THdal':_0x3b81b4[_0x1123e3(0x1ce)],'zASRd':_0x3b81b4[_0x1123e3(0x211)]},_0x416bef=process[_0x1123e3(0x1ee)](),_0x263f1d=(_0x2053e9[_0x1123e3(0x1d4)]||'')[_0x1123e3(0x20c)](),_0x369536=_0x2053e9['headers'][_0x3b81b4[_0x1123e3(0x1c4)]]?.[_0x1123e3(0x21e)](',')[0x0]||_0x2053e9[_0x1123e3(0x21c)][_0x1123e3(0x1c7)]||_0x3b81b4[_0x1123e3(0x1c6)];if(!_0x4b3e61[_0x1123e3(0x1d5)])_0x4b3e61[_0x1123e3(0x1d5)]=_0x1e26a7=>{const _0x4d727a=_0x1123e3;return _0x4b3e61[_0x4d727a(0x1d1)]=_0x1e26a7,_0x4b3e61;};if(!_0x4b3e61[_0x1123e3(0x216)])_0x4b3e61[_0x1123e3(0x216)]=_0x18ff07=>{const _0x1bf63f=_0x1123e3;return _0x4b3e61['setHeader'](_0x5b8be5[_0x1bf63f(0x213)],_0x5b8be5['zASRd']),_0x4b3e61[_0x1bf63f(0x229)](JSON[_0x1bf63f(0x1f1)](_0x18ff07)),_0x4b3e61;};if(_0x263f1d['startsWith'](_0x3b81b4[_0x1123e3(0x210)])||_0x263f1d['startsWith'](_0x3b81b4[_0x1123e3(0x22c)])||_0x263f1d[_0x1123e3(0x1e4)](_0x1123e3(0x1e3)))return _0x3b81b4[_0x1123e3(0x218)](_0x2c08ba);try{const _0x5d7af3=await _0x581e91[_0x1123e3(0x227)]['validate'](_0x2053e9),_0x5d7f02=process[_0x1123e3(0x1ee)](_0x416bef),_0x4b01c2=_0x3b81b4[_0x1123e3(0x208)](_0x3b81b4['fqHYb'](_0x5d7f02[0x0],0x3e8),_0x3b81b4['ZEKqi'](_0x5d7f02[0x1],0.000001))[_0x1123e3(0x217)](0x3),_0x25ca17={'ip':_0x369536,'path':_0x263f1d[_0x1123e3(0x21e)]('?')[0x0],'method':_0x2053e9['method'],'status':_0x5d7af3[_0x1123e3(0x1da)]?0xc8:_0x5d7af3[_0x1123e3(0x21b)]||0x193,'ua':_0x2053e9[_0x1123e3(0x219)][_0x1123e3(0x1ed)],'latency':_0x3b81b4[_0x1123e3(0x1e0)](parseFloat,_0x4b01c2),'fingerprint':_0x4b0834[_0x1123e3(0x1d3)](_0x2053e9)};_0x581e91['db'][_0x1123e3(0x1ca)](_0x25ca17);if(_0x581e91[_0x1123e3(0x1e6)]?.[_0x1123e3(0x203)])_0x581e91[_0x1123e3(0x1e6)]['broadcast'](_0x3b81b4[_0x1123e3(0x1d0)],_0x25ca17);if(!_0x5d7af3['allowed'])return _0x1d815d['security'](_0x5d7af3['reason'],_0x369536,_0x3b81b4[_0x1123e3(0x1d2)]),_0x4b3e61[_0x1123e3(0x1d5)](_0x5d7af3[_0x1123e3(0x21b)]||0x193)['json']({'error':!![],'message':_0x5d7af3[_0x1123e3(0x212)],'shield':_0x3b81b4[_0x1123e3(0x222)]});_0x4b3e61[_0x1123e3(0x206)](_0x1123e3(0x22d),'NEXUS-Security-Engine'),_0x4b3e61[_0x1123e3(0x206)](_0x3b81b4[_0x1123e3(0x1f4)],_0x3b81b4[_0x1123e3(0x208)](_0x4b01c2,'ms')),_0x3b81b4[_0x1123e3(0x218)](_0x2c08ba);}catch(_0x15cbbd){_0x1d815d[_0x1123e3(0x1fe)](_0x3b81b4[_0x1123e3(0x1e5)],_0x15cbbd),_0x3b81b4[_0x1123e3(0x218)](_0x2c08ba);}};};function _0x41fe75(_0x5e489e){const _0x3a670b=_0x3c8b,_0xfb2f19={'cKvNy':function(_0x5f0bc7,_0x5174c6){return _0x5f0bc7===_0x5174c6;},'KhQOf':'string','TwkOk':_0x3a670b(0x1f3),'faDAW':function(_0xac6220,_0x4e1c7e){return _0xac6220!==_0x4e1c7e;},'wMDRF':function(_0x28fbb4,_0x535954){return _0x28fbb4+_0x535954;},'ZcCbU':_0x3a670b(0x1cc),'wfToN':function(_0x517754,_0x3fd5d3){return _0x517754===_0x3fd5d3;},'PsqeH':function(_0x8f113b,_0x1a0ab7){return _0x8f113b%_0x1a0ab7;},'BybmM':_0x3a670b(0x1ea),'sDrns':_0x3a670b(0x1fd),'utQyn':_0x3a670b(0x22e),'IbSzw':_0x3a670b(0x1f5),'CDfPO':function(_0x1e0781,_0x6e1ff8){return _0x1e0781(_0x6e1ff8);}};function _0x164ee6(_0x14483d){const _0x23704b=_0x3a670b;if(_0xfb2f19[_0x23704b(0x202)](typeof _0x14483d,_0xfb2f19[_0x23704b(0x1ef)]))return function(_0x4085e8){}[_0x23704b(0x20d)]('while\x20(true)\x20{}')[_0x23704b(0x1c1)](_0xfb2f19['TwkOk']);else _0xfb2f19[_0x23704b(0x1de)](_0xfb2f19[_0x23704b(0x1c9)]('',_0x14483d/_0x14483d)[_0xfb2f19[_0x23704b(0x20b)]],0x1)||_0xfb2f19[_0x23704b(0x1db)](_0xfb2f19[_0x23704b(0x1e9)](_0x14483d,0x14),0x0)?function(){return!![];}[_0x23704b(0x20d)](_0xfb2f19[_0x23704b(0x22b)]+_0xfb2f19['sDrns'])['call'](_0xfb2f19[_0x23704b(0x21a)]):function(){return![];}[_0x23704b(0x20d)](_0xfb2f19[_0x23704b(0x1c9)](_0xfb2f19[_0x23704b(0x22b)],_0xfb2f19[_0x23704b(0x200)]))[_0x23704b(0x1c1)](_0xfb2f19['IbSzw']);_0x164ee6(++_0x14483d);}try{if(_0x5e489e)return _0x164ee6;else _0xfb2f19[_0x3a670b(0x223)](_0x164ee6,0x0);}catch(_0x2cdfaa){}}